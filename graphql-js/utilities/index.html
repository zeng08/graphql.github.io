<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><title>graphql/utilities | API 参考</title><meta name="viewport" content="width=640"/><meta property="og:title" content="GraphQL: 一种用于 API 的查询语言。"/><meta property="og:description" content="GraphQL 提供了 API 中数据的完整描述，提供让客户端能够准确地获取需要的数据而不包含任何冗余的能力，让 API 更加容易随着时间推移而演进，并提供强大的开发者工具。"/><meta property="og:type" content="website"/><meta property="og:url" content="http://graphql.cn/"/><meta property="og:image" content="/img/og_image.png"/><meta property="og:image:type" content="image/png"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@graphql"/><meta name="twitter:title" content="GraphQL: 一种用于 API 的查询语言。"/><meta name="twitter:description" content="GraphQL 提供让客户端能够准确地获取需要的数据而不包含任何冗余的能力，并让 API 更加容易随着时间推移而演进。"/><meta name="twitter:image" content="/img/twitter_image.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="home" type="application/rss+xml" href="/blog/rss.xml" title="GraphQL 团队博客"/><link rel="stylesheet" href="/style.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:300|Roboto:300"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,400i,600"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/></head><body><header><section><a class="nav-home" href="/"><img class="nav-logo" src="/img/logo.svg" width="30" height="30"/>GraphQL</a><nav><a href="/learn/">学习</a><a href="/code/">代码</a><a href="/community/">社区</a><a href="/blog/">博客</a><a href="http://spec.graphql.cn/" target="_blank" rel="noopener noreferrer">规范</a></nav><div class="algolia-search-wrapper"><input type="text" id="algolia-search-input" placeholder="搜索文档..."/></div></section></header><section><div class="documentationContent"><div class="inner-content"><h1>graphql/utilities</h1><div><p><code>graphql/utilities</code> 模块包含用于 GraphQL 语言和类型对象的常用计算。你可以从 <code>graphql/utilities</code> 模块或是 <code>graphql</code> 根模块引入。如下：</p><pre class="prism language-js"><span class="keyword">import</span> <span class="punctuation">{</span> introspectionQuery <span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">&#x27;graphql&#x27;</span><span class="punctuation">;</span> <span spellcheck="true" class="comment">// ES6</span>
<span class="keyword">var</span> <span class="punctuation">{</span> introspectionQuery <span class="punctuation">}</span> <span class="operator">=</span> <span class="function">require</span><span class="punctuation">(</span><span class="string">&#x27;graphql&#x27;</span><span class="punctuation">)</span><span class="punctuation">;</span> <span spellcheck="true" class="comment">// CommonJS</span></pre><h2><a class="anchor" name="概览"></a>概览 <a class="hash-link" href="#概览">#</a></h2><p><strong>内省（Introspection）</strong></p><div><ul class="apiIndex">
  <li>
    <a href="#introspectionquery">
      <pre>var introspectionQuery</pre>
      GraphQL 内省查询，包含足够的信息以重现类型系统。
    </a>
  </li>
  <li>
    <a href="#buildclientschema">
      <pre>function buildClientSchema</pre>
      通过使用 `introspectionQuery` 查询 schema 的结果，生成客户端 schema。
    </a>
  </li>
</ul>

</div><p><strong>Schema Language</strong></p><div><ul class="apiIndex">
  <li>
    <a href="#buildschema">
      <pre>function buildSchema</pre>
      基于 GraphQL schema language 构建一个 Schema 对象。
    </a>
  </li>
  <li>
    <a href="#printschema">
      <pre>function printSchema</pre>
      使用标准格式打印 schema。
    </a>
  </li>
  <li>
    <a href="#printintrospectionschema">
      <pre>function printIntrospectionSchema</pre>
      使用标准格式打印 schema 的内省特性。
    </a>
  </li>
  <li>
    <a href="#buildastschema">
      <pre>function buildASTSchema</pre>
      基于分析后的 AST Schema 构建 schema。
    </a>
  </li>
  <li>
    <a href="#typefromast">
      <pre>function typeFromAST</pre>
      在 GraphQLSchema 的 AST 中查找一个类型引用。
    </a>
  </li>
  <li>
    <a href="#astfromvalue">
      <pre>function astFromValue</pre>
      基于一个 JavaScript 值生成一个 GraphQL Input Value AST。
    </a>
  </li>
</ul>

</div><p><strong>Visitors</strong></p><div><ul class="apiIndex">
  <li>
    <a href="#typeinfo">
      <pre>class TypeInfo</pre>
      在 visitor 遍历 AST 时追踪类型和字段定义。
    </a>
  </li>
</ul>

</div><p><strong>值验证</strong></p><div><ul class="apiIndex">
  <li>
    <a href="#isvalidjsvalue">
      <pre>function isValidJSValue</pre>
      判断一个 JavaScript 值是否是有效的 GraphQL 类型的值。
    </a>
  </li>
  <li>
    <a href="#isvalidliteralvalue">
      <pre>function isValidLiteralValue</pre>
      判断一个 AST 中的字面量值是否是有效的 GraphQL 类型的值。
    </a>
  </li>
</ul>

</div><h2><a class="anchor" name="introspection"></a>内省（Introspection） <a class="hash-link" href="#introspection">#</a></h2><h3><a class="anchor" name="introspectionquery"></a>introspectionQuery <a class="hash-link" href="#introspectionquery">#</a></h3><pre class="prism language-js"><span class="keyword">var</span> introspectionQuery<span class="punctuation">:</span> string</pre><p>GraphQL 内省查询，用于查询服务器的内省系统，得到足够的信息以重现服务器类型系统。</p><h3><a class="anchor" name="buildclientschema"></a>buildClientSchema <a class="hash-link" href="#buildclientschema">#</a></h3><pre class="prism language-js"><span class="keyword">function</span> <span class="function">buildClientSchema</span><span class="punctuation">(</span>
  introspection<span class="punctuation">:</span> IntrospectionQuery
<span class="punctuation">)</span><span class="punctuation">:</span> GraphQLSchema</pre><p>构建客户端工具用的 GraphQLSchema。</p><p>假设客户端有运行内省查询的结果，创建并返回了一个 GraphQLSchema 实例，这个实例可以用于所有的 GraphQL.js 工具，但不能用于执行查询，因为内省并不代表有“解析器”、“分析”或者“序列化”函数，或者其他服务器内部机制。</p><h2><a class="anchor" name="schema-表示"></a>Schema 表示 <a class="hash-link" href="#schema-表示">#</a></h2><h3><a class="anchor" name="buildschema"></a>buildSchema <a class="hash-link" href="#buildschema">#</a></h3><pre class="prism language-js"><span class="keyword">function</span> <span class="function">buildSchema</span><span class="punctuation">(</span>source<span class="punctuation">:</span> string <span class="operator">|</span> Source<span class="punctuation">)</span><span class="punctuation">:</span> GraphQLSchema <span class="punctuation">{</span></pre><p>基于 GraphQL schema language 创建一个 GraphQLSchema 对象。schema 将会使用默认解析器。关于 GraphQL schema language 的更多细节，请查看 <a href="/learn/schema/">schema language 文档</a> 或者 <a href="https://wehavefaces.net/graphql-shorthand-notation-cheatsheet-17cd715861b6#.9oztv0a7n" target="_blank" rel="nofollow noopener noreferrer">schema language 速查表</a>。</p><h3><a class="anchor" name="printschema"></a>printSchema <a class="hash-link" href="#printschema">#</a></h3><pre class="prism language-js"><span class="keyword">function</span> <span class="function">printSchema</span><span class="punctuation">(</span>schema<span class="punctuation">:</span> GraphQLSchema<span class="punctuation">)</span><span class="punctuation">:</span> string <span class="punctuation">{</span></pre><p>使用 Schema Language 格式打印给定的 schema。</p><h3><a class="anchor" name="printintrospectionschema"></a>printIntrospectionSchema <a class="hash-link" href="#printintrospectionschema">#</a></h3><pre class="prism language-js"><span class="keyword">function</span> <span class="function">printIntrospectionSchema</span><span class="punctuation">(</span>schema<span class="punctuation">:</span> GraphQLSchema<span class="punctuation">)</span><span class="punctuation">:</span> string <span class="punctuation">{</span></pre><p>使用 Schema Language 格式打印内建的内省 schema。</p><h3><a class="anchor" name="buildastschema"></a>buildASTSchema <a class="hash-link" href="#buildastschema">#</a></h3><pre class="prism language-js"><span class="keyword">function</span> <span class="function">buildASTSchema</span><span class="punctuation">(</span>
  ast<span class="punctuation">:</span> SchemaDocument<span class="punctuation">,</span>
  queryTypeName<span class="punctuation">:</span> string<span class="punctuation">,</span>
  mutationTypeName<span class="punctuation">:</span> <span class="operator">?</span>string
<span class="punctuation">)</span><span class="punctuation">:</span> GraphQLSchema</pre><p>这个函数需要一个 schema 文档的 ast（可通过 <code>graphql/language/schema</code> 的 <code>parseSchemaIntoAST</code> 生成）构建一个 GraphQLSchema 实例，这个实例可以用于所有的 GraphQL.js 工具，但不能用于执行查询，因为内省并不代表有“解析器”、“分析”或者“序列化”函数，或者其他服务器内部机制。</p><h3><a class="anchor" name="typefromast"></a>typeFromAST <a class="hash-link" href="#typefromast">#</a></h3><pre class="prism language-js"><span class="keyword">function</span> <span class="function">typeFromAST</span><span class="punctuation">(</span>
  schema<span class="punctuation">:</span> GraphQLSchema<span class="punctuation">,</span>
  inputTypeAST<span class="punctuation">:</span> Type
<span class="punctuation">)</span><span class="punctuation">:</span> <span class="operator">?</span>GraphQLType</pre><p>给定一个出现在 GraphQL AST 和 Schema 中的类型名称，返回其在 schema 中对应的 GraphQLType。</p><h3><a class="anchor" name="astfromvalue"></a>astFromValue <a class="hash-link" href="#astfromvalue">#</a></h3><pre class="prism language-js"><span class="keyword">function</span> <span class="function">astFromValue</span><span class="punctuation">(</span>
  value<span class="punctuation">:</span> any<span class="punctuation">,</span>
  type<span class="operator">?</span><span class="punctuation">:</span> <span class="operator">?</span>GraphQLType
<span class="punctuation">)</span><span class="punctuation">:</span> <span class="operator">?</span>Value</pre><p>基于一个 JavaScript 值生成一个 GraphQL Input Value AST。</p><p>可选参数，一个 GraphQL 类型，用于消除类型原生值之间的歧义。</p><h2><a class="anchor" name="visitors"></a>Visitors <a class="hash-link" href="#visitors">#</a></h2><h3><a class="anchor" name="typeinfo"></a>TypeInfo <a class="hash-link" href="#typeinfo">#</a></h3><pre class="prism language-js"><span class="keyword">class</span> <span class="class-name">TypeInfo</span> <span class="punctuation">{</span>
  <span class="function">constructor</span><span class="punctuation">(</span>schema<span class="punctuation">:</span> GraphQLSchema<span class="punctuation">)</span>
  <span class="function">getType</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="operator">?</span>GraphQLOutputType <span class="punctuation">{</span>
  <span class="function">getParentType</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="operator">?</span>GraphQLCompositeType <span class="punctuation">{</span>
  <span class="function">getInputType</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="operator">?</span>GraphQLInputType <span class="punctuation">{</span>
  <span class="function">getFieldDef</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="operator">?</span>GraphQLFieldDefinition <span class="punctuation">{</span>
  <span class="function">getDirective</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="operator">?</span>GraphQLDirective <span class="punctuation">{</span>
  <span class="function">getArgument</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="operator">?</span>GraphQLArgument <span class="punctuation">{</span>
<span class="punctuation">}</span></pre><p>TypeInfo 是一个工具类，在 GraphQL 文档 AST 的递归分析中的任何位置上，调用 <code>enter(node)</code> 和 <code>leave(node)</code> 的时候，可以追踪指定 GraphQL schema 中当前字段和类型定义。</p><h2><a class="anchor" name="值验证"></a>值验证 <a class="hash-link" href="#值验证">#</a></h2><h3><a class="anchor" name="isvalidjsvalue"></a>isValidJSValue <a class="hash-link" href="#isvalidjsvalue">#</a></h3><pre class="prism language-js"><span class="keyword">function</span> <span class="function">isValidJSValue</span><span class="punctuation">(</span>value<span class="punctuation">:</span> any<span class="punctuation">,</span> type<span class="punctuation">:</span> GraphQLInputType<span class="punctuation">)</span><span class="punctuation">:</span> string<span class="punctuation">[</span><span class="punctuation">]</span></pre><p>给定一个 JavaScript 值和 GraphQL 类型，判断这个值是否能被这个类型接受。这个功能在验证运行时查询参数值的时候特别有用。</p><h3><a class="anchor" name="isvalidliteralvalue"></a>isValidLiteralValue <a class="hash-link" href="#isvalidliteralvalue">#</a></h3><pre class="prism language-js"><span class="keyword">function</span> <span class="function">isValidLiteralValue</span><span class="punctuation">(</span>
  type<span class="punctuation">:</span> GraphQLInputType<span class="punctuation">,</span>
  valueAST<span class="punctuation">:</span> Value
<span class="punctuation">)</span><span class="punctuation">:</span> string<span class="punctuation">[</span><span class="punctuation">]</span></pre><p>验证器的工具可以判断 AST 字面量值是否是一个给定输入类型的有效值。</p><p>注意，这个功能只验证字面量值，并假设变量值是正确的类型。</p></div><a class="read-next" href="/graphql-js/validation"><span class="read-next-continue">继续阅读 →</span><span class="read-next-title">graphql/validation</span></a></div><div class="nav-docs"><div><h3>GraphQL.js 教程</h3><ul><li><a style="margin-left:0;" class="active" href="/graphql-js/">入门</a></li><li><a style="margin-left:0;" class="active" href="/graphql-js/running-an-express-graphql-server/">Express + GraphQL</a></li><li><a style="margin-left:0;" class="active" href="/graphql-js/graphql-clients/">GraphQL 客户端</a></li><li><a style="margin-left:0;" class="active" href="/graphql-js/basic-types/">基本类型</a></li><li><a style="margin-left:0;" class="active" href="/graphql-js/passing-arguments/">传递参数</a></li><li><a style="margin-left:0;" class="active" href="/graphql-js/object-types/">对象类型</a></li><li><a style="margin-left:0;" class="active" href="/graphql-js/mutations-and-input-types/">变更和输入类型</a></li><li><a style="margin-left:0;" class="active" href="/graphql-js/authentication-and-express-middleware/">认证 &amp; 中间件</a></li></ul></div><div><h3>高级指南</h3><ul><li><a style="margin-left:0;" class="active" href="/graphql-js/constructing-types/">构建类型</a></li></ul></div><div><h3>API 参考</h3><ul><li><a style="margin-left:0;" class="active" href="/graphql-js/express-graphql/">express-graphql</a><ul><li><a href="/graphql-js/express-graphql/#graphqlhttp">graphqlHTTP</a></li></ul></li><li><a style="margin-left:0;" class="active" href="/graphql-js/graphql/">graphql</a><ul><li><a href="/graphql-js/graphql/#graphql">graphql</a></li></ul></li><li><a style="margin-left:0;" class="active" href="/graphql-js/error/">graphql/error</a><ul><li><a href="/graphql-js/error/#formaterror">formatError</a></li><li><a href="/graphql-js/error/#graphqlerror">GraphQLError</a></li><li><a href="/graphql-js/error/#locatederror">locatedError</a></li><li><a href="/graphql-js/error/#syntaxerror">syntaxError</a></li></ul></li><li><a style="margin-left:0;" class="active" href="/graphql-js/execution/">graphql/execution</a><ul><li><a href="/graphql-js/execution/#execute">execute</a></li></ul></li><li><a style="margin-left:0;" class="active" href="/graphql-js/language/">graphql/language</a><ul><li><a href="/graphql-js/language/#break">BREAK</a></li><li><a href="/graphql-js/language/#getlocation">getLocation</a></li><li><a href="/graphql-js/language/#kind">Kind</a></li><li><a href="/graphql-js/language/#lex">lex</a></li><li><a href="/graphql-js/language/#parse">parse</a></li><li><a href="/graphql-js/language/#parsevalue">parseValue</a></li><li><a href="/graphql-js/language/#printsource">printSource</a></li><li><a href="/graphql-js/language/#visit">visit</a></li></ul></li><li><a style="margin-left:0;" class="active" href="/graphql-js/type/">graphql/type</a><ul><li><a href="/graphql-js/type/#getnamedtype">getNamedType</a></li><li><a href="/graphql-js/type/#getnullabletype">getNullableType</a></li><li><a href="/graphql-js/type/#graphqlboolean">GraphQLBoolean</a></li><li><a href="/graphql-js/type/#graphqlenumtype">GraphQLEnumType</a></li><li><a href="/graphql-js/type/#graphqlfloat">GraphQLFloat</a></li><li><a href="/graphql-js/type/#graphqlid">GraphQLID</a></li><li><a href="/graphql-js/type/#graphqlinputobjecttype">GraphQLInputObjectType</a></li><li><a href="/graphql-js/type/#graphqlint">GraphQLInt</a></li><li><a href="/graphql-js/type/#graphqlinterfacetype">GraphQLInterfaceType</a></li><li><a href="/graphql-js/type/#graphqllist">GraphQLList</a></li><li><a href="/graphql-js/type/#graphqlnonnull">GraphQLNonNull</a></li><li><a href="/graphql-js/type/#graphqlobjecttype">GraphQLObjectType</a></li><li><a href="/graphql-js/type/#graphqlscalartype">GraphQLScalarType</a></li><li><a href="/graphql-js/type/#graphqlschema">GraphQLSchema</a></li><li><a href="/graphql-js/type/#graphqlstring">GraphQLString</a></li><li><a href="/graphql-js/type/#graphqluniontype">GraphQLUnionType</a></li><li><a href="/graphql-js/type/#isabstracttype">isAbstractType</a></li><li><a href="/graphql-js/type/#iscompositetype">isCompositeType</a></li><li><a href="/graphql-js/type/#isinputtype">isInputType</a></li><li><a href="/graphql-js/type/#isleaftype">isLeafType</a></li><li><a href="/graphql-js/type/#isoutputtype">isOutputType</a></li></ul></li><li><a style="margin-left:0;" class="active" href="/graphql-js/utilities/">graphql/utilities</a><ul><li><a href="/graphql-js/utilities/#astfromvalue">astFromValue</a></li><li><a href="/graphql-js/utilities/#buildastschema">buildASTSchema</a></li><li><a href="/graphql-js/utilities/#buildclientschema">buildClientSchema</a></li><li><a href="/graphql-js/utilities/#buildschema">buildSchema</a></li><li><a href="/graphql-js/utilities/#introspectionquery">introspectionQuery</a></li><li><a href="/graphql-js/utilities/#isvalidjsvalue">isValidJSValue</a></li><li><a href="/graphql-js/utilities/#isvalidliteralvalue">isValidLiteralValue</a></li><li><a href="/graphql-js/utilities/#printintrospectionschema">printIntrospectionSchema</a></li><li><a href="/graphql-js/utilities/#printschema">printSchema</a></li><li><a href="/graphql-js/utilities/#typefromast">typeFromAST</a></li><li><a href="/graphql-js/utilities/#typeinfo">TypeInfo</a></li></ul></li><li><a style="margin-left:0;" class="active" href="/graphql-js/validation/">graphql/validation</a><ul><li><a href="/graphql-js/validation/#specifiedrules">specifiedRules</a></li><li><a href="/graphql-js/validation/#validate">validate</a></li></ul></li></ul></div></div></div></section><footer><section class="sitemap"><a href="/" class="nav-home"></a><div><h5><a href="/learn/">学习</a></h5><a href="/learn/">入门</a><a href="/learn/queries/">查询语言</a><a href="/learn/schema/">类型系统</a><a href="/learn/execution/">执行</a><a href="/learn/best-practices/">最佳实践</a></div><div><h5><a href="/code">代码</a></h5><a href="/code/#server-libraries">服务端</a><a href="/code/#graphql-clients">客户端</a><a href="/code/#tools">工具</a></div><div><h5><a href="/community">社区</a></h5><a href="/community/upcoming-events/">即将到来的活动</a><a href="http://stackoverflow.com/questions/tagged/graphql" target="_blank" rel="noopener noreferrer">Stack Overflow</a><a href="https://www.facebook.com/groups/graphql.community/" target="_blank" rel="noopener noreferrer">Facebook Group</a><a href="https://twitter.com/GraphQL" target="_blank" rel="noopener noreferrer">Twitter</a></div><div><h5>更多</h5><a href="/blog">GraphQL 团队博客</a><a href="http://spec.graphql.cn/" target="_blank" rel="noopener noreferrer">阅读规范</a><a href="https://github.com/graphql" target="_blank" rel="noopener noreferrer">GitHub</a><a href="https://github.com/xitu/graphql.github.io/edit/zh-Hans/site/graphql-js/APIReference-Utilities.md" target="_blank" rel="noopener noreferrer">编辑本页 ✎</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" rel="noopener noreferrer" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright ©<span><script>document.write(new Date().getFullYear())</script> </span><noscript>2017 </noscript>Facebook Inc. The contents of this page are licensed BSD-3-Clause.</section></footer><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
        docsearch({
          apiKey: 'd103541f3e6041148aade2e746ed4d61',
          indexName: 'graphql',
          inputSelector: '#algolia-search-input'
        });
      </script><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-44373548-16', 'auto');
ga('send', 'pageview');
      </script></body></html>